--=============================================================================
--	Filename	:	uitables.sql
--	Author		:	DB2 Team 
--	Date		:	OCT/10/2010
--  Description	:
--=============================================================================


CALL EDIDB2A.SP_UTIL_DROP( 'TABLE EDIDB2A.T_USER_ROLES ') ;

CREATE TABLE EDIDB2A.T_USER_ROLES (
	USER_ID BIGINT NOT NULL,
	ROLE_ID BIGINT NOT NULL,
	PRIORITY INTEGER NOT NULL,
	DATE_ACTIVATED TIMESTAMP,
	ACTIVATED_BY VARCHAR(30)
);
CALL EDIDB2A.SP_UTIL_DROP( 'TABLE EDIDB2A.T_ROLE') ;

CREATE TABLE EDIDB2A.T_ROLE (
	ID BIGINT NOT NULL,
	ROLE_NME VARCHAR(30),
	ROLE_DESC VARCHAR(255)
	);
	
ALTER TABLE EDIDB2A.T_ROLE	ADD CONSTRAINT  X_T_ROLE PRIMARY KEY (ID);

CALL EDIDB2A.SP_UTIL_DROP( 'TABLE EDIDB2A.T_USER') ;

CREATE TABLE EDIDB2A.T_USER (
	ID BIGINT NOT NULL,
	LOGINID VARCHAR(10) NOT NULL,
	PASSWD VARCHAR(50),
	FNME VARCHAR(30) NOT NULL,
	LNME VARCHAR(30) NOT NULL,
	EMAIL VARCHAR(30) NOT NULL,
	OFFICE_PHONE VARCHAR(15),
	DEPT_ID INTEGER NOT NULL,
	ACTIVE CHARACTER(1) DEFAULT 'N',
	LAST_LOGIN_TS TIMESTAMP,
	LAST_LOGOUT_TS TIMESTAMP,
	CREATED_BY VARCHAR(30),
	CREATED_TS TIMESTAMP,
	AUTHORIZED_BY VARCHAR(30),
	AUTHORIZED_TS TIMESTAMP,
	MODIFIED_BY VARCHAR(30),
	MODIFIED_TS TIMESTAMP,
	DEACTIVATED_BY VARCHAR(30),
	DEACTIVATED_TS TIMESTAMP
);

ALTER TABLE EDIDB2A.T_USER 	ADD CONSTRAINT  X_T_USER  PRIMARY KEY (ID);

INSERT INTO EDIDB2A.T_USER_ROLES(USER_ID, ROLE_ID, PRIORITY, DATE_ACTIVATED, ACTIVATED_BY) VALUES (10080, 104, 1, '2010-05-06 03:27:00.0', 'mchennu');
INSERT INTO EDIDB2A.T_USER_ROLES(USER_ID, ROLE_ID, PRIORITY, DATE_ACTIVATED, ACTIVATED_BY) VALUES (10081, 104, 1, '2010-05-06 03:27:00.0', 'mchennu');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (139, 'AppUser', 'Application User');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (140, 'AppAdmin', 'Application Administrator');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (141, 'TPUser', 'Trading Partner User');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (142, 'TPAdmin', 'Trading Partner Administrator');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (143, 'EFUser', 'EDI Files User');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (144, 'EFAdmin', 'EDI Files Administrator');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (145, 'TRNUser', 'Transaction User');
INSERT INTO EDIDB2A.T_ROLE(ID, ROLE_NME, ROLE_DESC) VALUES (146, 'TRNAdmin', 'Transaction Administrator');
INSERT INTO EDIDB2A.T_USER(ID, LOGINID, PASSWD, FNME, LNME, EMAIL, OFFICE_PHONE, DEPT_ID, ACTIVE, LAST_LOGIN_TS, LAST_LOGOUT_TS, CREATED_BY, CREATED_TS, AUTHORIZED_BY, AUTHORIZED_TS, MODIFIED_BY, MODIFIED_TS, DEACTIVATED_BY, DEACTIVATED_TS) VALUES (10080, 'e127110', '#156#159#162#165#168', 'Mary', 'Agnello', 'magnello@bcbsm.com', '123-456-1800', 1001, 'A', '2010-03-29 03:19:06.0', '2010-03-29 03:19:06.0', 'mchennu', '2010-05-06 03:20:00.0', 'mchennu', '2010-05-06 03:26:00.0', null, null, null, null);
INSERT INTO EDIDB2A.T_USER(ID, LOGINID, PASSWD, FNME, LNME, EMAIL, OFFICE_PHONE, DEPT_ID, ACTIVE, LAST_LOGIN_TS, LAST_LOGOUT_TS, CREATED_BY, CREATED_TS, AUTHORIZED_BY, AUTHORIZED_TS, MODIFIED_BY, MODIFIED_TS, DEACTIVATED_BY, DEACTIVATED_TS) VALUES (10081, 'e127911', '#156#159#162#165#168', 'Puneeth', 'Nanda', 'pnanda@bcbsm.com', '123-456-1800', 1001, 'A', '2010-03-29 03:19:06.0', '2010-03-29 03:19:06.0', 'mchennu', '2010-05-06 03:20:00.0', 'mchennu', '2010-05-06 03:26:00.0', null, null, null, null);


--=============================================================================
--	Table Name:	T_WIP
--	Description:
--		Used to store all the various files that are being worked on by the
--		Users as part of the Recreate, Resubmit and Retransmit options.
--
--=============================================================================

CALL EDIDB2A.SP_UTIL_DROP( 'TABLE EDIDB2A.T_WIP');

CREATE TABLE EDIDB2A.T_WIP(
	ID			BIGINT NOT NULL GENERATED ALWAYS AS IDENTITY 
				(  	START WITH +10000 	INCREMENT BY +1  
					MINVALUE +10000  	MAXVALUE +9223372036854775807  
					NO CYCLE  CACHE 20  NO ORDER 
				) ,
	TRAN_NUM		VARCHAR(5),
	FILE_NME		VARCHAR(255),
	WIP_STT_CD		CHAR(1),
	WIP_ACT_CD		CHAR(1),
	FILE_ID			BIGINT,
	ORIG_FILE_ID	BIGINT,
	RCVR_ID         VARCHAR(15),
    SUBM_ID         VARCHAR(15),
    ISA_CTRL_NUM    VARCHAR(9),
    DIR             CHARACTER(1), 
	CREATED_BY		VARCHAR(15),
	ASSIGNED_TO		VARCHAR(15),
	RSUBM_PNT_CD	CHARACTER(1),
	PERF_DUP_CHK_CD	CHARACTER(1),
	CREATED_TS		TIMESTAMP,
	CLOSED_TS		TIMESTAMP,
	CMT				VARCHAR(150)
);

ALTER TABLE  EDIDB2A.T_WIP  ADD CONSTRAINT XPKT_WIP PRIMARY KEY (ID);
CREATE INDEX EDIDB2A.TRAN_NUM_FILE_ID 	ON EDIDB2A.T_WIP (TRAN_NUM,FILE_ID);
CREATE INDEX EDIDB2A.ASSIGNED_TO 		ON EDIDB2A.T_WIP (ASSIGNED_TO);
CREATE INDEX EDIDB2A.CREATED_BY 		ON EDIDB2A.T_WIP (CREATED_BY);

CALL EDIDB2A.SP_UTIL_DROP( 'TABLE EDIDB2A.T_TP_REPORTS');

CREATE TABLE EDIDB2A.T_TP_REPORTS (
  ID				BIGINT	NOT NULL	GENERATED ALWAYS
					AS IDENTITY (START WITH 100000001, INCREMENT BY 1, CACHE 120,
					MINVALUE 100000000, NO MAXVALUE, NO CYCLE, NO ORDER),
  TRANS_NUM			VARCHAR(5),
  REPORT_NME		VARCHAR(30),
  FILE_NME			VARCHAR(255),
  DIRECTORY			VARCHAR(255),
  START_TS			TIMESTAMP,
  STOP_TS			TIMESTAMP
) ;
  